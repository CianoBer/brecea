	IF NOT EXISTS (SELECT 1 FROM SYSOBJECTS WHERE ID = OBJECT_ID('MET_IMPORTORE') AND TYPE = 'U')
	CREATE TABLE MET_IMPORTORE
	(
		TIPODOC			VARCHAR(3)		NOT NULL	DEFAULT ''	,
		ESERCIZIO		DECIMAL(5,0)	NOT NULL	DEFAULT 0	,
		DATADOC			DATE									,
		CODFOR			VARCHAR(7)		NOT NULL	DEFAULT ''	,
		ARTICOLO		VARCHAR(50)		NOT NULL	DEFAULT ''	,
		QTA				DECIMAL(16,6)	NOT NULL	DEFAULT 0	,
		PREZZO			DECIMAL(19,6)	NOT NULL	DEFAULT 0	,
		RIFCOMM			VARCHAR(30)		NOT NULL	DEFAULT ''	,
		DATACONS		DATETIME								,
		CCOSTO			VARCHAR(10)		NOT NULL	DEFAULT''	,
		UTENTEMODIFICA	VARCHAR(25)		NOT NULL				,
		DATAMODIFICA	DATETIME NOT	NULL
	)
	GO
	GRANT REFERENCES, SELECT, UPDATE, INSERT, DELETE  ON MET_IMPORTORE TO METODO98
	GO
	
	IF EXISTS(SELECT 1 FROM SysObjects WHERE ID=object_id('MET_VISTAARTICOLICDC_ORE') AND Type='V')
		DROP VIEW MET_VISTAARTICOLICDC_ORE
	GO
	CREATE VIEW MET_VISTAARTICOLICDC_ORE AS
	SELECT 
		A.CODICE,
		A.CODCATEGORIASTAT,
		MTC.VALORE
	FROM 
		ANAGRAFICAARTICOLI AS A
		INNER JOIN MET_TABCATSTAT_CDC AS MTC ON A.CODCATEGORIASTAT=MTC.CODICE
	GO
	GRANT SELECT ON MET_VISTAARTICOLICDC_ORE TO METODO98
	GO